<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="BrownianMotionApp.Views.BrownianMotionChartPage"
             xmlns:vm="clr-namespace:BrownianMotionApp.ViewModels"
             x:DataType="vm:BrownianMotionChartViewModel"
             xmlns:material="http://schemas.enisn-projects.io/dotnet/maui/uraniumui/material"
             xmlns:icons="clr-namespace:UraniumUI.Icons.MaterialSymbols;assembly=UraniumUI.Icons.MaterialSymbols"
             xmlns:input="clr-namespace:InputKit.Shared.Controls;assembly=InputKit.Maui"
             xmlns:inputValidations="clr-namespace:InputKit.Shared.Validations;assembly=InputKit.Maui"
             xmlns:drawables="clr-namespace:BrownianMotionApp.Utils.Drawables"
             xmlns:validations="clr-namespace:BrownianMotionApp.Utils.Validations"
             Title="Gerador de Movimento Browniano">

    <ContentPage.Resources>
        <drawables:BrownianMotionDrawable x:Key="brownianMotionDrawable" />
    </ContentPage.Resources>

    <Grid ColumnDefinitions="*,*"
          RowDefinitions="*"
          ColumnSpacing="25"
          Margin="100,50">

        <GraphicsView x:Name="brownianMotionChartView"
                      Grid.Column="0"
                      Drawable="{StaticResource brownianMotionDrawable}"
                      VerticalOptions="Fill"
                      HorizontalOptions="Fill" />

        <ScrollView Grid.Column="1">
            <input:FormView Spacing="25"
                            SubmitCommand="{Binding GenerateCommand}">
                <Grid ColumnDefinitions="*,*"
                      ColumnSpacing="25">

                    <Label Grid.Column="0"
                           Text="Parâmetros"
                           Style="{StaticResource Headline}" />

                    <Button Grid.Column="1"
                            Text="Randomizar"
                            HorizontalOptions="End"
                            StyleClass="FilledButton"
                            Command="{Binding RandomizeCommand}">
                        <Button.ImageSource>
                            <FontImageSource FontFamily="MaterialSharp"
                                             Size="20"
                                             Glyph="{x:Static icons:MaterialSharp.Casino}"
                                             Color="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource PrimaryDarkText}}" />
                        </Button.ImageSource>
                    </Button>
                </Grid>

                <material:TextField Title="Preço Inicial"
                                    Text="{Binding InitialPrice}">
                    <inputValidations:RequiredValidation Message="Este campo é obrigatório" />
                    <validations:PositiveNumericValidation />
                </material:TextField>
                <material:TextField Title="Volatilidade Média (%)"
                                    Text="{Binding Volatility}">
                    <inputValidations:RequiredValidation Message="Este campo é obrigatório" />
                    <validations:PositiveOrZeroNumericValidation />
                </material:TextField>
                <material:TextField Title="Retorno Médio (%)"
                                    Text="{Binding MeanReturn}">
                    <inputValidations:RequiredValidation Message="Este campo é obrigatório" />
                    <validations:MinMaxNumericValidation MinValue="-100"
                                                         MaxValue="100" />
                </material:TextField>
                <material:TextField Title="Tempo (dias)"
                                    Text="{Binding NumDays}">
                    <inputValidations:RequiredValidation Message="Este campo é obrigatório" />
                    <validations:IntegerValidation />
                    <validations:MinMaxNumericValidation MinValue="1"
                                                         MaxValue="1825" />
                </material:TextField>

                <Grid ColumnDefinitions="*,*"
                      ColumnSpacing="25">

                    <material:TextField Grid.Column="0"
                                        Title="Número de Simulações"
                                        Text="{Binding NumSimulations}">
                        <inputValidations:RequiredValidation Message="Este campo é obrigatório" />
                        <validations:IntegerValidation />
                        <validations:MinMaxNumericValidation MinValue="1"
                                                             MaxValue="10" />
                        <material:TextField.Attachments>
                            <Grid ColumnDefinitions="50,50">
                                <Button Grid.Column="0"
                                        BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource PrimaryDarkText}}"
                                        CornerRadius="0"
                                        Command="{Binding StepDownSimulationCountCommand}">
                                    <Button.ImageSource>
                                        <FontImageSource FontFamily="MaterialSharp"
                                                         Size="20"
                                                         Glyph="{x:Static icons:MaterialSharp.Minimize}"
                                                         Color="{AppThemeBinding Light={StaticResource PrimaryDarkText}, Dark={StaticResource White}}" />
                                    </Button.ImageSource>
                                </Button>
                                <Button Grid.Column="1"
                                        BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource PrimaryDarkText}}"
                                        CornerRadius="0"
                                        Command="{Binding StepUpSimulationCountCommand}">
                                    <Button.ImageSource>
                                        <FontImageSource FontFamily="MaterialSharp"
                                                         Size="20"
                                                         Glyph="{x:Static icons:MaterialSharp.Add}"
                                                         Color="{AppThemeBinding Light={StaticResource PrimaryDarkText}, Dark={StaticResource White}}" />
                                    </Button.ImageSource>
                                </Button>
                            </Grid>
                        </material:TextField.Attachments>
                    </material:TextField>

                    <material:DropdownField Grid.Column="1"
                                            Title="Cores"
                                            SelectedItem="{Binding SelectedPalette}"
                                            ItemsSource="{Binding PaletteTypes}"
                                            SelectedItemChangedCommand="{Binding SelectedPaletteChangedCommand}"
                                            AllowClear="False" />
                </Grid>


                <Button Text="Gerar"
                        StyleClass="FilledButton"
                        input:FormView.IsSubmitButton="True"
                        Grid.Column="0">
                    <Button.ImageSource>
                        <FontImageSource FontFamily="MaterialSharp"
                                         Size="20"
                                         Glyph="{x:Static icons:MaterialSharp.Refresh}"
                                         Color="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource PrimaryDarkText}}" />
                    </Button.ImageSource>
                </Button>
            </input:FormView>
        </ScrollView>
    </Grid>
</ContentPage>